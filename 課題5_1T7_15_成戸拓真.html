<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="utf-8">
	<title>ジグソーパズル</title>
	<style>
		.piece {
			width: 64px;
			height: 64px;
			background-image: url("pict.jpg");
			position: absolute;
		}
	</style>
	<script src="jquery-3.4.1.min.js"></script>
	<script>

		// 処理1-1変数の定義
		var pieces = 25;
		var sel = -1;
		var pos = [];

		$(function () {
			// 処理1-2 ピース分割とピースの番号付け
			for (var i = 0; i < pieces; i++) pos[i] = i;


			// 処理2-1 ピースの位置を入れ替える
			for (var i = pieces; i > 0; i--) {
				var j = Math.floor(Math.random() * i);
				swap(i - 1, j);
			}

			// 処理2-2 画面上にピースを配置する
			for (var i = 0; i < pieces; i++) {
				$('<div id="piece ' + i + '"class="piece"></div>')
					.css({
						backgroundPosition: '-' + getx(i) + 'px -' + gety(i) + 'px',
						left: getx(pos[i]), top: gety(pos[i])
					}).appendTo($('body'));
			};

			// 処理3-1 ピースをクリックしたときの処理その１
			$('.piece').click(function () {
				var no = this.id.substring(5);
				// 処理3-2 ピースをクリックしたときの処理その２…同じピースを選択したとき
				if (sel == no) {
					$(this).fadeTo(100, 1);
					sel = -1;
				} else if (sel == -1) {
					$(this).fadeTo(100, 0.5);
					sel = no;
				}
				// 処理3-4 ピースをクリックしたときの処理その４…他のピースが選択されているとき
				else {
					swap(no, sel);
					$('#piece' + sel).fadeTo(100, 1).animate({ left: getx(pos[sel]), top: gety(pos[sel]) });
					$(this).animate({ left: getx(pos[no]), top: gety(pos[no]) }, function () {
						var clear = true;
						for (var i = 0; i < pieces; i++) if (pos[i] !== i) clear = false;
						if (clear) alert("クリア!");
					});
					sel = -1;


				};


			});




			// 処理4 1枚の絵に戻ったら完成とする




			// 関数1ピースの位置を入れ替える
			function swap(i, j) {
				var tmp = pos[i];
				pos[i] = pos[j];
				pos[j] = tmp;
			};

			// 関数2ピースの位置から画像のx座標を返す
			function getx(n) {
				return (n % 5) * 64;
			}


			// 関数3ピースの位置から画像のy座標を返す
			function gety(n) {
				return Math.floor(n / 5) * 64;
			}
		});


	</script>
</head>

<body>
</body>

</html>